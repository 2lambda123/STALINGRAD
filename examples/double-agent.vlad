(include "math")

(define (double-agent wa wab paa pab pabb raa rabb o)
 (argmax
  (lambda (a)
   (raa (paa (wa (wa ((invert paa) o) a)
		 (argmax (lambda (a-prime)
			  (rabb (pabb (wab ((invert pabb)
					    (pab (wa ((invert paa) o) a)))
					   a-prime))))
			 5
			 1e-5)))))
  5
  1e-5))

(double-agent (lambda (s a) (+ s a))
	      (lambda (s a) (+ s a))
	      (lambda (s) s)
	      (lambda (s) s)
	      (lambda (s) s)
	      (lambda (o) (- 0 (sqr (- o 3))))
	      (lambda (o) (- 0 (sqr (- o 1))))
	      2)
